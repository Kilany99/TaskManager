<Window x:Class="TaskManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TaskManager.Utilities"
        xmlns:utilities="clr-namespace:TaskManager.Utilities"
        xmlns:local1="clr-namespace:TaskManager.Utilities.Converters"
        xmlns:enums="clr-namespace:TaskManager.Enums"
        xmlns:services="clr-namespace:TaskManager.Services;assembly=TaskManager"
        Title="Personal Task Manager" Height="450" Width="1000">
    <Window.Resources>
        <local:PriorityToColorConverter x:Key="PriorityToColorConverter"/>
        <local1:BooleanToStrikethroughConverter x:Key="BooleanToStrikethroughConverter"/>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="3*"/>
            <ColumnDefinition Width="1.5*"/>
        </Grid.ColumnDefinitions>

        <!-- Left Panel - Task List -->
        <DockPanel Margin="10">
            <!-- Search and Filter -->
            <StackPanel DockPanel.Dock="Top" Margin="0,0,0,10">
                <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                         Margin="0,5" Padding="5"
                         Tag="Search tasks..."/>

                <!-- Category Filter -->
                <ComboBox ItemsSource="{Binding Categories}"
                          SelectedItem="{Binding SelectedCategory}"
                          DisplayMemberPath="Name"
                          Margin="0,5">
                    <ComboBox.Style>
                        <Style TargetType="ComboBox">
                            <Style.Triggers>
                                <Trigger Property="SelectedItem" Value="{x:Null}">
                                    <Setter Property="Tag" Value="Filter by category"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ComboBox.Style>
                </ComboBox>

                <!-- Tag Filter -->
                <ComboBox ItemsSource="{Binding AvailableTags}"
                          SelectedItem="{Binding SelectedFilterTag}"
                          DisplayMemberPath="Name"
                          Margin="0,5">
                    <ComboBox.Style>
                        <Style TargetType="ComboBox">
                            <Style.Triggers>
                                <Trigger Property="SelectedItem" Value="{x:Null}">
                                    <Setter Property="Tag" Value="Filter by tag"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ComboBox.Style>
                </ComboBox>
            </StackPanel>

            <!-- Task List -->
            <ListView ItemsSource="{Binding Tasks}"
                      SelectedItem="{Binding SelectedTask}">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <!-- ... (same as before) ... -->
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </DockPanel>

        <!-- Middle Panel - Task Details -->
        <StackPanel Grid.Column="1" Margin="10">
            <!-- ... (same detail fields as before) ... -->

            <!-- Priority -->
            <ComboBox ItemsSource="{utilities:EnumBindingSource EnumType=enums:Priority}"
          SelectedValue="{Binding SelectedTask.Priority}"
          Margin="0,0,0,10">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="16" Height="16" Margin="0,0,5,0"
                           Fill="{Binding Converter={StaticResource PriorityToColorConverter}}"/>
                            <TextBlock Text="{Binding}"/>
                        </StackPanel>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            <!-- Category -->
            <ComboBox ItemsSource="{Binding Categories}"
                      SelectedItem="{Binding SelectedTask.Category}"
                      DisplayMemberPath="Name"
                      Margin="0,0,0,10"/>
        </StackPanel>

        <!-- Right Panel - Actions -->
        <StackPanel Grid.Column="2" Margin="10">
            <Button Content="Add Task" Command="{Binding TaskManager.AddTaskCommand}" 
                    Margin="0,0,0,10"/>
            <Button Content="Delete Task" Command="{Binding TaskManager.DeleteTaskCommand}" 
                    Margin="0,0,0,10"/>
            <Button Content="Save Task" Command="{Binding TaskManager.SaveTaskCommand}" 
                    Margin="0,0,0,10"/>
        </StackPanel>
    </Grid>
</Window>