<Window x:Class="TaskManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TaskManager.Utilities.Converters"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:enums="clr-namespace:TaskManager.Enums"
        xmlns:utilities="clr-namespace:TaskManager.Utilities"
        Title="Personal Task Manager" Height="450" Width="1000">
    <Window.Resources>
        <utilities:PriorityToColorConverter x:Key="PriorityToColorConverter"/>
        
        <local:BooleanToStrikethroughConverter x:Key="BooleanToStrikethroughConverter"/>
        <Style TargetType="TextBox">
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="ToolTip" 
                        Value="{Binding RelativeSource={RelativeSource Self}, 
                        Path=(Validation.Errors)[0].ErrorContent}"/>
                    <Setter Property="Background" Value="#FFF7D7D7"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="ComboBox">
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="ToolTip" 
                        Value="{Binding RelativeSource={RelativeSource Self}, 
                        Path=(Validation.Errors)[0].ErrorContent}"/>
                    <Setter Property="BorderBrush" Value="Red"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="3*"/>
            <ColumnDefinition Width="1.5*"/>
        </Grid.ColumnDefinitions>

        <!-- Left Panel - Task List -->
        <DockPanel Margin="10">
            <!-- Search and Filter -->
            <StackPanel DockPanel.Dock="Top" Margin="0,0,0,10">
                <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                         Margin="0,5" Padding="5"/>

                <!-- Category Filter -->
                <ComboBox ItemsSource="{Binding Categories}"
                          SelectedItem="{Binding SelectedCategory}"
                          DisplayMemberPath="Name"
                          Margin="0,5">
                    <ComboBox.Style>
                        <Style TargetType="ComboBox">
                            <Setter Property="Tag" Value="Filter by category"/>
                            <Style.Triggers>
                                <Trigger Property="SelectedItem" Value="{x:Null}">
                                    <Setter Property="Tag" Value="All Categories"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ComboBox.Style>
                </ComboBox>

                <!-- Tag Filter -->
                <ListBox ItemsSource="{Binding AvailableTags}"
         SelectionMode="Multiple"
         Margin="0,5">
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="ListBoxItem">
                            <Setter Property="IsSelected" Value="{Binding IsSelected}"/>
                        </Style>
                    </ListBox.ItemContainerStyle>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <CheckBox Content="{Binding Name}" 
                      IsChecked="{Binding IsSelected, Mode=TwoWay}"/>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </StackPanel>

            <!-- Task List -->
            <ListView ItemsSource="{Binding FilteredTasks}">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <!-- Item content here -->
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </DockPanel>

        <!-- Middle Panel - Task Details -->
        <StackPanel Grid.Column="1" Margin="10">
            <!-- Title -->
            <TextBox Text="{Binding NewTask.Title, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
             Margin="0,5" Padding="5"/>

            <!-- Description -->
            <TextBox Text="{Binding NewTask.Description, UpdateSourceTrigger=PropertyChanged}"
             Margin="0,5" Padding="5"/>

            <!-- Due Date -->
            <DatePicker SelectedDate="{Binding NewTask.DueDate, ValidatesOnDataErrors=True}"
                Margin="0,5"/>

            <!-- Priority -->
            <ComboBox ItemsSource="{utilities:EnumBindingSource EnumType=enums:Priority}"
              SelectedValue="{Binding NewTask.Priority}"
              Margin="0,5">
                <!-- Item template remains same -->
            </ComboBox>

            <!-- Category -->
            <ComboBox ItemsSource="{Binding Categories}"
              SelectedItem="{Binding NewTask.Category}"
              DisplayMemberPath="Name"
              Margin="0,5"/>

            <!-- Tags -->
            <ListBox ItemsSource="{Binding AvailableTags}" 
         SelectionMode="Multiple">
                <i:Interaction.Behaviors>
                    <utilities:ListBoxSelectedItemsBehavior 
            SelectedItems="{Binding SelectedTags, Mode=TwoWay}"/>
                </i:Interaction.Behaviors>

                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <CheckBox Content="{Binding Name}" 
                      IsChecked="{Binding IsSelected, Mode=TwoWay}"/>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </StackPanel>

        <!-- Right Panel - Actions -->
        <StackPanel Grid.Column="2" Margin="10">
            <Button Content="Add Task" 
            Command="{Binding AddCommand}"
            Margin="0,0,0,10"/>
        
        <Button Content="🗑️ Delete Task" 
                    Command="{Binding DeleteCommand}" 
                    Margin="0,0,0,10"
                    Padding="10,5"
                    FontWeight="Bold"/>

            <Button Content="💾 Save Task" 
                    Command="{Binding SaveCommand}" 
                    Margin="0,0,0,10"
                    Padding="10,5"
                    FontWeight="Bold"/>
        </StackPanel>
    </Grid>
</Window>